<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jincomp.jintest.web.jin.mapper.BookMapper">
	<resultMap type="com.jincomp.jintest.web.jin.vo.EventVO"
		id="EventVO">
		<result column="EVENT_ID" property="eventId" />
		<result column="FIX_DISCOUNT" property="fixDiscount" />
		<result column="RATE_STR_DAY" property="rateStrDay" />
		<result column="RATE_END_DAY" property="rateEndDay" />
		<result column="RATE" property="rate" />
	</resultMap>

	<resultMap type="com.jincomp.jintest.web.jin.vo.RentVO"
		id="RentVO">
		<result column="USER_NO" property="userNo" />
		<result column="GOODS_ID" property="goodsId" />
		<result column="START_DATE" property="startDate" />
		<result column="END_DATE" property="endDate" />
	</resultMap>

	<resultMap type="com.jincomp.jintest.web.jin.vo.BookVO"
		id="BookVO">
		<result column="GOODS_ID" property="goodsId" />
		<result column="GOODS_NAME" property="goodsName" />
		<result column="GOODS_PRICE" property="goodsPrice" />
		<result column="EVENT_ID" property="eventId" />
		<collection property="eventVo" resultMap="EventVO" />
		<collection property="rentVo" resultMap="RentVO" />

		<!-- 다른테이블에서 참조하는 컬럼의 값을 가져오기 위해 -->
	</resultMap>

	<resultMap type="com.jincomp.jintest.web.jin.vo.UserVO"
		id="UserVO">
		<result column="USER_NO" property="userNo" />
		<result column="USER_NAME" property="userName" />
		<result column="USER_ID" property="userId" />
		<result column="USER_PASSWORD" property="userPassword" />
		<result column="USER_ADDRESS" property="userAddress" />
	</resultMap>


	<!-- main에서 사용자가 대여할때 쓰는 리스트 쿼리문 -->
	<select id="bookList"
		resultType="com.jincomp.jintest.web.jin.vo.BookVO" resultMap="BookVO">
		SELECT
		b.GOODS_ID,
		b.GOODS_NAME,
		b.GOODS_PRICE,
		b.EVENT_ID,
		bco.USER_NO,
		bco.GOODS_ID,
		bco.START_DATE,
		bco.END_DATE,
		e.EVENT_ID,
		e.FIX_DISCOUNT,
		e.RATE_STR_DAY,
		e.RATE_END_DAY,
		e.RATE
		FROM BOOKS b
		LEFT OUTER JOIN
		BOOKS_CHECK_OUT bco
		ON
		b.GOODS_ID = bco.GOODS_ID
		LEFT OUTER JOIN
		EVENT e
		ON
		b.EVENT_ID= e.EVENT_ID

	</select>

	<select id="rentList">
	</select>

</mapper>